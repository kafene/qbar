<!DOCTYPE HTML>
<html lang="en">
<head>
  <title>Q bar</title>
  <meta charset="utf-8">
  <link rel="icon" href="data:image/png;base64,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">
</head>
<body>
  <form id="form" action="index.html" method="GET">
    <input class="query" id="q" type="text" name="q" value="" autofocus /><!--
 --><input class="button" type="submit" value="Q" />
  </form>
  <div class="info" id="info"></div>
</body>

<!-- CONFIG -->
<script type="text/javascript">
engines = [
  {
    k:'g', n:'google',
    u:'https://google.com',
    s:'https://google.com/search?q=%s',
  }, {
    k:'y', n:'youtube',
    u:'https://www.youtube.com',
    s:'https://www.youtube.com/results?search_query=%s',
  }, {
    k:'m', n:'google maps',
    u:'https://maps.google.com',
    s:'https://maps.google.com/maps?q=%s',
  }, {
    k:'i', n:'google images',
    u:'https://google.com',
    s:'https://google.com/search?tbm=isch&q=%s',
  }, {
    k:'d', n:'duck duck go',
    s:'https://duckduckgo.com/?k1=-1&kp=-1&q=%s',
  }, {
    k:'gh', n:'github',
    u:'https://github.com/unu',
    s:'https://github.com/search?q=%s',
  }, {
    k:'a', n:'alternativeto',
    u:'http://alternativeto.net',
    s:'http://alternativeto.net/SearchResult.aspx?profile=all&search=%s',
  }, {
    k:'w', n:'wikipedia.cz',
    u:'https://cs.wikipedia.org',
    s:'https://cs.wikipedia.org/w/index.php?search=%s',
  }, {
    k:'r', n:'rlslog',
    u:'http://www.rlslog.net',
    s:'http://www.rlslog.net/?s=%s',
  }, {
    k:'u', n:'ulož.to',
    u:'http://www.uloz.to',
    s:'http://www.uloz.to/hledej/?q=%s',
  }, {
    k:'c', n:'čsfd',
    u:'http://www.csfd.cz',
    s:'http://www.csfd.cz/hledat/?q=%s',
  }, {
    k:'t', n:'titulky',
    u:'http://www.titulky.com',
    s:'http://www.titulky.com/index.php?Fulltext=%s',
  }, {
    k:'cs', n:'en > cs',
    u:'http://translate.google.com',
    s:'http://translate.google.com/#en|cs|%s',
  }, {
    k:'en', n:'cs > en',
    u:'http://translate.google.com',
    s:'http://translate.google.com/#cs|en|%s',
  }, {
    k:'rss', n:'google reader',
    u:'https://reader.google.com',
  }, {
    k:'gm', n:'gmail',
    u:'https://mail.google.com',
  }, {
    k:'+', n:'google+',
    u:'https://plus.google.com',
  }, {
    k:'db', n:'dropbox',
    u:'https://dropbox.com',
  }, {
    k:'gb', n:'gimme bar',
    u:'https://gimmebar.com',
  }, {
    k:'x', n:'xkcd',
    u:'https://xkcd.com/',
  }, {
    k:'l', n:'localhost',
    u:'http://localhost',
  },
];
debug = false;

// FUNCTIONS
function get_param() {
  a = {};
  window.location.href.replace(/[?&]+([^=&]+)=?([^&]*)/gi, 
    function(m,k,v){
      try{ a[k] = decodeURIComponent(v); }
      catch(err){ a[k] = ''; } // %s bug in firefox
    });
  return a;
}
function info(s, a){
  box = document.getElementById('info');
  if (a) box.innerHTML += s;
  else   box.innerHTML  = s;
}
function shrink(s){
  return s.trim().replace(/ +/g, ' ');
}
function list(){
  m = '';
  e = '';
  for (i in engines){
    s = '<b>' + engines[i].k + '</b> ' + engines[i].n + '<br>';
    if (engines[i].s) e += s;
    else m += s;
  }
  info('<h3>Engines</h3>' + e + '<h3>Bookmarks</h3>' + m);
}
function get_engine(k, s){
  for (i in engines){
    if (engines[i].k == k){
      if (!(!engines[i].s && s))  return engines[i];
    }
  }
}
function search(q, go){
  full = q;
  q = shrink(q);
  a = q.split(' ')[0];
  s = q.substr(a.length).trim();
  // list commands
  //if (!q || q == '%s') info('');
  if (q == "ls" || !q || q == '%s') list();
  // load url
  else if (q.match(/^https?:\/\/[^ ]+$/i) || full.match(/^[^ ]+\.[^ ]{2,}$/)){
    if (!q.match(/^https?:\/\/[^ ]+$/i)) q = 'http://' + q;
    info('Go to: <a href="' + q + '">' + q + '</a>');
    if (!debug && go) window.location.assign(q);
  }
  // search or bookmark
  else {
    e = get_engine(a, s);
    // default engine
    if (!e){
      e = engines[0];
      s = q;
    }
    // search
    if ((e.s && s) || (!e.u && !s)){
      url = e.s.replace(/%s/gi, encodeURIComponent(s));
    }
    // bookmark
    else url = e.u;
    info('<b>' + e.n + '</b> ' + ((!s && e.s)?'...':s) + '<br>');
    info('<a href="' + url + '">' + url + '</a>', true);
    if (!debug && go) window.location.assign(url);
  }
}

// ONLOAD
window.onload = function(){
  q = document.getElementById('q');
  form = document.getElementById('form');
  q.value = '';
  q.focus();
  if (get_param().d != undefined) debug = true;
  form.onsubmit = function(){
    search(q.value, true);
    return false;
  };
  q.onkeyup = function(){
    search(q.value);
  };
  if (get_param().q){
    q.value = get_param().q;
    search(q.value, true);
  }
  else search(q.value);
};
</script>

<!-- STYLE -->
<style>
body{
  margin: 0 auto;
  margin-top: 4em;
  width: 25em;
  font-size: 18px;
  font-family: "Droid Sans", "Tahoma", sans;
  color: #444;
}
:focus{
  outline:none
}
a{
  text-decoration: none
}
a, a:visited{
  color: #bbb
}
a:hover{
  color: #888
}
a:active{
  color: #555
}
h3{
  margin: .7em 0 .2em
}
form{
  font-family: inherit
}
input{
  padding: 10px;
  border: 1px solid #aaa;
  width: 3em;
  font-size: inherit;
  margin-bottom: 1em;
}
.button{
  padding: 9px;
  border-radius: 0 6px 6px 0;
  background-color: #f5f5f5;
}
.button:hover{
  background-color: #fff
}
.button:active{
  background-color: #eee
}
.query{
  background-color: #fff;
  width: 20em;
  border-right: none;
  border-radius: 6px 0 0 6px;
  box-shadow: 0 0 4px #eee inset;
}
.info{
  padding: .5em;
}
.info b{
  display: inline-block;
  min-width: 2em;
}
</style>

</html>
