<!DOCTYPE HTML>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Q bar</title>
</head>
<body>
  <form id="form" action="index.html" method="GET">
    <input class="query" id="q" type="text" name="q" value="" autofocus />
    <input class="button" type="submit" value="Q" />
  </form>
  <div class="info" id="info"></div>
</body>


<!-- STYLE -->
<style>
:focus {outline:none}
::-moz-focus-inner {border:0}
body{
  margin: 10em auto;
  width: 30em;
  font-size: 20px;
}
form{
  font-family: "Droid Sans", "Tahoma", sans;
}
input{
  padding: .5em;
  border: 1px solid #aaa;
  background-color: #f8f8f8;
  font-size: 20px;
  width: 3em;
  margin-bottom: 1em;
  border-radius: 3px;
}
.button:hover{
  background-color: #fff;
}
.button:active{
  background-color: #eee;
}
.query{
  width: 20em;
}
.info{
  padding: .5em;
}
</style>


<!-- SCRIPT -->
<script type="text/javascript">

// CONFIG
default_engine = "g";
engines= {
  g: {s: 'https://google.com/search?q=%s', n: 'Google'},
  y: {s: 'https://www.youtube.com/results?search_query=%s', n: 'YouTube'},
  m: {s: 'https://maps.google.com/maps?q=%s', n: 'Google Maps'},
  d: {s: 'https://duckduckgo.com/?k1=-1&kp=-1&q=%s', n: 'DuckDuckGo'},
  x: {s: 'https://xkcd.com/', n: 'xkcd'},
};
debug = false;

// FUNCTIONS
function get_param() {
  v = {};
  window.location.href.replace(/[?&]+([^=&]+)=?([^&]*)/gi, 
    function(m,a,b){ v[a] = decodeURIComponent(b); });
  return v;
}
function info(s){
  document.getElementById('info').innerHTML = s;
}
function trim(s){
  return s.replace(/^ */, '').replace(/ *$/, '');
}
function list(){
  var list = '';
  for (e in engines)
    list = list + '<b>' + e + ':</b> ' + engines[e]['n'] + '<br>';
  info(list);
}
function search(q){
  q = q.trim();
  a = q.split(' ')[0];
  if (a == "ls") list();
  else if (q){
    if (engines[a])
      q = q.substr(a.length).trim();
    else
      a = default_engine;
    name = engines[a]['n'];
    url = engines[a]['s'];
    url = url.replace(/%s/gi, encodeURIComponent(q));
    dtext = debug ? '<a href="' + url + '">' + url + '</a>' : '';
    info('<b>' + name + '</b> ' + q + '<br>' + dtext);
    if (!debug) window.location.assign(url);
  }
}

// ONLOAD
window.onload = function(){
  list();
  param = get_param()['q'];
  if (param) search(decodeURIComponent(param));
  if (get_param()['d'] != undefined) debug = true;
  document.getElementById('form').onsubmit = function(){
    search(document.getElementById('q').value);
    return false;
  };
};

</script>
</html>
